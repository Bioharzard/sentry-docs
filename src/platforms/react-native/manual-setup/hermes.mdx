---
title: Hermes
sidebar_order: 30
description: "Learn about using the Hermes engine with our React Native SDK."
redirect_from:
  - /platforms/react-native/hermes/
---

Sentry added support for `react-native` builds that use the `hermes` engine, which required changes to the sentry SDK, `sentry-cli` as well as Sentry itself.

Sentry customers using the SaaS product (sentry.io) will need to update the SDK, and `sentry-cli`.
The minimum required version for the SDK is `@sentry/react-native` [SDK version `1.3.3`](https://github.com/getsentry/sentry-react-native/releases/tag/1.3.3),
and `@sentry/cli` [version `1.51.1`](https://github.com/getsentry/sentry-cli/releases/tag/1.51.1).

For self-hosted Sentry users, the minimum version required is [f07352b](https://hub.docker.com/r/getsentry/sentry/tags?page=1&name=f07352b).

Once you have the minimum version of the SDK, Sentry provides the standard integration as described in the [React Native Sentry documentation](/platforms/react-native/).

<Note>

If you are using Hermes, you should not have the [RAM bundles](/platforms/react-native/manual-setup/ram-bundles/) feature enabled. In Hermes, when loading the bytecode, `mmap` ensures that the entire file is not loaded. Using Hermes with RAM bundles might lead to issues, because those mechanisms are not compatible with each other.

</Note>

## Source Maps

If you do not need custom source maps, the `sentry.gradle` build step fully supports Hermes source maps.

```bash {tabTitle:Android}
                Welcome to Metro v0.73.7
              Fast - Scalable - Integrated


info Writing bundle output to:, /Users/username/Library/Developer/Xcode/DerivedData/YourApp-dtnzz/Build/Products/Release/main.jsbundle
info Writing sourcemap output to:, /Users/username/Library/Developer/Xcode/DerivedData/YourApp-dtnzz/Build/Intermediates.noindex/YourApp.build/Release/YourApp.build/DerivedSources/main.jsbundle.map
info Done writing bundle output
info Done writing sourcemap output
```

```bash {tabTitle:iOS}
                Welcome to Metro v0.73.7
              Fast - Scalable - Integrated


info Writing bundle output to:, /Users/username/Library/Developer/Xcode/DerivedData/YourApp-dtnzz/Build/Products/Release/main.jsbundle
info Writing sourcemap output to:, /Users/username/Library/Developer/Xcode/DerivedData/YourApp-dtnzz/Build/Intermediates.noindex/YourApp.build/Release/YourApp.build/DerivedSources/main.jsbundle.map
info Done writing bundle output
info Done writing sourcemap output
```

## Custom Source Maps

If you are manually bundling and building React Native apps, follow this three-step process. Be aware that it's important to exactly match the steps of React Native tooling. Otherwise the generated bundle and source maps might be working incorrectly, for example pointing to unrelated lines. 

The React Native tooling steps are extracted from [`react-native-xcode.sh`](https://github.com/facebook/react-native/blob/0.71-stable/scripts/react-native-xcode.sh) for iOS and from [`BundleHermesCTask.kt`](https://github.com/facebook/react-native/blob/0.71-stable/packages/react-native-gradle-plugin/src/main/kotlin/com/facebook/react/tasks/BundleHermesCTask.kt) for Android. 

<Note>
[`BundleHermesCTask.kt`](https://github.com/facebook/react-native/blob/0.71-stable/packages/react-native-gradle-plugin/src/main/kotlin/com/facebook/react/tasks/BundleHermesCTask.kt) is only available from `0.71`. Version before use [`react.gradle`](https://github.com/facebook/react-native/blob/0.70-stable/react.gradle). 
</Note>

### Compile Source maps

<Note>

We recommend you to use bundle and source map generated by RN tooling. In case you are having issues with the manually generated artifacts take a look at this [issue](https://github.com/facebook/react-native/issues/34043) for more details.

</Note>

1. Bundle/minify with `metro` (`react-native`) to get the bundle (`.bundle` or `.jsbundle`) and packager source map (`.map`):

```bash {tabTitle:Android}
npx react-native bundle --platform android --dev false --entry-file index.js --reset-cache --bundle-output index.android.bundle --sourcemap-output index.android.bundle.packager.map --minify false
```

```bash {tabTitle:iOS}
npx react-native bundle --platform ios --dev false --entry-file index.js --reset-cache --bundle-output main.jsbundle --sourcemap-output main.jsbundle.packager.map --minify false
```

<Note>

If you are running Hermes with JS Bundle you only need step one, but replace `main.jsbundle.packager.map` and `index.android.bundle.packager.map` with `main.jsbundle.map` and `index.android.bundle.map` in the commands respectively.

</Note>

2. Compile to bytecode using `hermes` to get the compiler source map (`.hbc.map`):

Hermes engine can interpret both JS bundle and Hermes bytecode. It's important to verify that you JS bundle generated by the your App build process is actually compiled by hermes and that Hermes bytecode bundle is bundled with your app. This is typically issue on iOS where you need to enabled Hermes in [`ios/Podfile`](https://reactnative.dev/docs/hermes#ios) but you also need `$USE_HERMES` environment variable set to `true` for the build tools to use Hermes compiler.

<Note>

`OS-BIN` is `osx-bin`, `win64-bin`, or `linux64-bin`, depending on which operating system you are using.

</Note>

If you're using Hermes with **React Native 0.68 or below**:

```bash {tabTitle:Android}
node_modules/hermes-engine/{OS-BIN}/hermesc -O -emit-binary -output-source-map -out=index.android.bundle.hbc index.android.bundle
rm -f index.android.bundle
mv index.android.bundle.hbc index.android.bundle
```

```bash {tabTitle:iOS}
sample-new-architecture/ios/Pods/hermes-engine/destroot/bin/hermesc -O -emit-binary -output-source-map -out=main.jsbundle.hbc main.jsbundle
rm -f main.jsbundle
mv main.jsbundle.hbc main.jsbundle
```

Starting with **React Native 0.69**, `hermes` has been [shipped with React Native](https://reactnative.dev/blog/2022/06/21/version-069#bundled-hermes), so you should use `hermesc` from `react-native`:

```bash {tabTitle:Android}
node_modules/react-native/sdks/hermesc/{OS-BIN}/hermesc -O -emit-binary -output-source-map -out=index.android.bundle.hbc index.android.bundle
rm -f index.android.bundle
mv index.android.bundle.hbc index.android.bundle
```

```bash {tabTitle:iOS}
sample-new-architecture/ios/Pods/hermes-engine/destroot/bin/hermesc -O -emit-binary -output-source-map -out=main.jsbundle.hbc main.jsbundle
rm -f main.jsbundle
mv main.jsbundle.hbc main.jsbundle
```

3. Merge the two source maps using `compose-source-maps` to get the final source map (`.map`):

```bash {tabTitle:Android}
node node_modules/react-native/scripts/compose-source-maps.js index.android.bundle.packager.map index.android.bundle.hbc.map -o index.android.bundle.map
```

```bash {tabTitle:iOS}
node node_modules/react-native/scripts/compose-source-maps.js main.jsbundle.packager.map main.jsbundle.hbc.map -o main.jsbundle.map
```

### Upload the Bundle and Source Maps

Upload your source maps following [Step 3 on the normal source maps guide](/platforms/react-native/sourcemaps/#3-upload-the-bundle-and-source-maps).

<Note>

You will upload the `index.android.bundle` and `index.android.bundle.map` for Android, `main.jsbundle` and `main.jsbundle.map` for iOS.

</Note>

<Note>

When uploaded, the `index.android.bundle` file will be sized at 0 bytes. This is expected with Hermes bytecode and won't affect the source maps resolution.

</Note>
